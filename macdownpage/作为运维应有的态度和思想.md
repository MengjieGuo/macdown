# 作为运维应有的态度和思想
[参考链接🔗](http://www.jianshu.com/p/16e952ca444a)
## 需要做什么
>变更的大致流程是：需求确认 -> 干系业务/人确定 -> 方案探讨 -> 方案确立&时间确立 -> 变更单撰写 -> 变更单 review -> 审批报备 -> 变更通告 -> 方案实施 -> 方案效果反馈 (-> 回滚方案)，可酌情进行步骤删减。遵循变更流程的主要好处是，首先，你可以在整理变更步骤的时候仔细思考每一处风险点，多次变更之后可以固化下来风险相对较小的标准化文档，后续可以把重复操作自动化。其次，风险均摊及最小化，方案是大家探讨后确定的，时间是大家商量后认可的，流程是经过审批报备的。真的，如果把类似的流程贯彻下去，因为变更产生故障的概率会大大降低。现在成熟的公司运维团队，都已经把类似的流程固化到运维平台里了，但是又有多少团队的负责人真正在遵循，而不是随便审批了事呢？不要和我谈业务压力有多大，不要和我谈缺人手，原则是不能却步的，否则捡了芝麻丢了西瓜。

1. 保证程序有数据可用，如果程序需要删除数据文件，请修改为移动到大的磁盘下。
2. 每天从数据库同步数据到本地时要做备份（非增量方式同步），可以备份这几天的，然后在需要删除数据时确认是否删除最久的数据，即使忘记删除，积累几天也不会有大问题，磁盘空间一般够用。数据库都有数据备份与恢复机制，可以定时手动save文件到磁盘，以时间为文件名。需要还原数据时就找到需要的备份数据恢复到数据库。
3. 同步数据的时机，早7点到晚6点是用户使用高峰期，数据库也会被多次使用，经常会出现数据库连接池满或者数据库负荷工作的情况，这种情况下我们是没法成功连接数据库的。TNS：time out这样的错误就会出现。
4. 同步数据可以先从数据源拉取数据，保存到文件中，以日期保存。同步数据文件到另一台服务器后进行同样的数据文件备份操作。
5. 程序需要更新加入新的功能时，把需要的功能实现一个测试一个，测试通过后打小版本的小标签，测试时只需要测试这一个功能。
6. 测试流程很重要，需要在开发者本机进行测试（单元测试），在线下测试（集成测试），没有问题后部署到线上进行最后测试，及时不通过，也可以回到上一个版本。这是测试和版本控制。
7. 一定在线下模拟线上环境，模拟后一定要把代码放在环境下测试。
8. 如果项目有多个小项目配合工作，各个部分的版本需要对应，其中一个换版本，其他的可能也需要换。
9. 代码要加入注释，注释方式可以时测试用例，可以是调用说明。
10. 代码重构。
11. 配置服务器的服务，ftp服务，nginx服务，ssh服务，邮件服务等，都可以脚本化完成。
12. 服务器安全性，ssh防暴力破解，nginx防网站攻击
13. 考虑为完成一件部署需要做的是，比如使用代理时需要服务器开放端口，ssh登陆，配置密码。

## 需要学什么
1. 解决问题的能力
2. 学习的能力
3. sql知识
4. vi知识
5. shell知识
6. docker知识
7. nginx知识
8. linux、shell知识，安全知识
9. 网络知识，安全知识
10. 代码能力
11. 高要求意识、忧患意识、进取意识、主动学习
12. 质疑精神，确定自己的操作带来的影响

## 怎么做，有什么工具可以帮助我们
1. 编写sql语句从数据库取数据，sql语句需要经过工具的验证。
2. 监控工具的使用，可以是别人的联网工具，也可以是开源的像open-falcon，都可以通过浏览器访问图形化的统计信息，配置报警策略，添加监控平台和平台服务，配置邮箱和手机号。

###其他工具
1. xshell
2. cyberduck
3. remoteDesktop

## 优化部署过程
1. 脚本实现自动化部署，可能需要多个脚本完成这个部署流程，但是一次成功就等于接下来会一直成功，除非部署流程发生变化。
2. 自动化版本切换。
3. 添加一台服务器时，对环境进行初始化，可以多个脚本完成不同的功能初始化。
4. 断网安装一个软件包以及依赖。